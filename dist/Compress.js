export function compress(e,t=9){if(0===e.length)return Buffer.from("Yaz0\0\0\0\0\0\0\0\0\0\0\0\0");let f=Buffer.allocUnsafe(4);if(f.writeUInt32BE(e.length),e.length<4)return Buffer.concat([Buffer.from("Yaz0"),f,Buffer.alloc(8),Buffer.from([255<<8-e.length]),e]);let l=+t?function(e,t){let f=[],l=0,r=e.length-1;e:for(;r>=0;){let n=r-2;if(n>0){let o=r-1;for(let u=1;u<=t&&!(r-u<0);u++)if(e[r]===e[r-u]&&e[o]===e[o-u]&&e[n]===e[n-u]){let t=3;for(r-=3;t<273&&0!==r&&e[r]===e[r-u];t++)r--;u--,t<18?(l+=2,f.push([u>>8|t-2<<4,255&u])):(l+=3,f.push([u>>8,255&u,t-18]));continue e}}l++,f.push([e[r--]])}let n=0,o=0,u=Buffer.allocUnsafe(Math.ceil(f.length/8)+l);for(let e=0;e<f.length;e++){let t=f[f.length-e-1];e%8==0&&(u.writeUInt8(0,n),o=n++),1===t.length?(u.writeUInt8(t[0],n),u[o]|=1<<7-e%8):2===t.length?u.writeUInt16BE(t[0]<<8|t[1],n):u.writeUIntBE(t[0]<<16|t[1]<<8|t[2],n,3),n+=t.length}return u}(e,9>+t?4320*t/9-224:4096):function(e){let t=Math.ceil(e.length/8),f=Buffer.alloc(t+e.length,255);for(let l=0;l<t;l++)e.copy(f,9*l+1,8*l,(l+1)*8);let l=8*t-e.length;return l&&(f[(t-1)*9]=255<<l),f}(e);return Buffer.concat([Buffer.from("Yaz0"),f,Buffer.alloc(8),l])}